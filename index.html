<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Simple Kanban Board</title>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Delius&family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap');
    
    * {
        box-sizing: border-box;
        font-family: 'Nunito', Arial, sans-serif;
    }

    body {
        margin: 0;
        background: #fff3fc;
        padding: 20px;
    }

    h1 {
        text-align: center;
        margin-bottom: 20px;
    }

    #task-input {
        border-radius: 10px;
        padding: 10px 15px;
        font-size: 1rem;
        background: #fff;
        border: 2px solid #000000;
        box-shadow: 3px 3px 0 #000000;
    }

    #column-select {
        border-radius: 10px;
        padding: 10px 15px;
        font-size: 1rem;
        background: #fff;
        border: 2px solid #000000;
        box-shadow: 3px 3px 0 #000000;
    }

    #add-button {
        border-radius: 10px;
        padding: 10px 15px;
        font-size: 1rem;
        background: #fff;
        color: #000;
        border: 2px solid #000000;
        box-shadow: 3px 3px 0 #000000;
        cursor: pointer;
    }

    #add-form {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        max-width: 600px;
        margin: 0 auto 20px;
    }

    #add-form input, #add-form select, #add-form button {
        padding: 10px;
        font-size: 14px;
    }

    #columns {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 15px;
        margin-top: 20px;
    }

    .column {
        background: white;
        border-radius: 10px;
        min-height: 300px;
        padding: 10px 15px;
        font-size: 1rem;
        background: #fff;
        color: #000;
        border: 2px solid #000000;
        box-shadow: 3px 3px 0 #000000;
        cursor: pointer;
        
    }

    .column h2 {
        margin: 0 0 10px;
        font-size: 18px;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .item {
        background: #000;
        color: white;
        padding: 10px;
        border-radius: 10px;
        margin-bottom: 10px;
        cursor: grab;
    }

    .item.dragging {
        opacity: 0.4;
    }

    .delete-btn {
        float: right;
        font-size: 12px;
        background: white;
        color: black;
        border: none;
        padding: 2px 6px;
        border-radius: 10px;
        cursor: pointer;
    }
</style>
</head>
<body>
    <h1>Simple Kanban Board</h1>

    <form id="add-form">
        <input type="text" id="task-input" placeholder="New task..." required />
        <select id="column-select">
            <option value="todo">To Do</option>
            <option value="inprogress">In Progress</option>
            <option value="inreview">In Review</option>
            <option value="done">Done</option>
        </select>
        <button type="submit" id="add-button">Add</button>
    </form>

    <div id="columns">
        <div class="column" id="todo" ondragover="allowDrop(event)" ondrop="drop(event, 'todo')">
            <h2>TO DO</h2>
        </div>

        <div class="column" id="inprogress" ondragover="allowDrop(event)" ondrop="drop(event, 'inprogress')">
            <h2>IN PROGRESS</h2>
        </div>

        <div class="column" id="inreview" ondragover="allowDrop(event)" ondrop="drop(event, 'inreview')">
            <h2>IN REVIEW</h2>
        </div>

        <div class="column" id="done" ondragover="allowDrop(event)" ondrop="drop(event, 'done')">
            <h2>DONE</h2>
        </div>
    </div>

    <script>
        const STORAGE_KEY = 'kanban-board';
        
        let draggedItem = null;

        function saveBoard() {
            const data = {};
            document.querySelectorAll('.column').forEach(col => {
                const items = [...col.querySelectorAll('.item')].map(i => i.outerHTML);
                data[col.id] = items;
            });
            localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
        }


        function loadBoard() {
            const raw = localStorage.getItem(STORAGE_KEY);
            if (!raw) return;

            const data = JSON.parse(raw);

            for (const col in data) {
                const column = document.getElementById(col);

                // Keep the h2, remove only old items
                column.querySelectorAll('.item').forEach(i => i.remove());

                data[col].forEach(itemHTML => {
                    const div = document.createElement('div');
                    div.innerHTML = itemHTML;
                    const item = div.firstChild;

                    item.addEventListener("dragstart", dragStart);
                    item.addEventListener("dragend", dragEnd);

                    column.appendChild(item);
                });
            }
        }


        function reattachEvents() {
            document.querySelectorAll('.item').forEach(item => {
                item.draggable = true;
                item.addEventListener('dragstart', dragStart);
                item.addEventListener('dragend', dragEnd);
            });
        }

        function dragStart(e) {
            draggedItem = this;
            this.classList.add('dragging');
        }

        function dragEnd(e) {
            this.classList.remove('dragging');
        }

        function allowDrop(e) {
            e.preventDefault();
        }

        document.getElementById('add-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const text = document.getElementById('task-input').value;
            const columnId = document.getElementById('column-select').value;
            addItem(text, columnId);
            document.getElementById('task-input').value = '';
        });

        loadBoard();

        function addItem(text, columnId) {
            const column = document.getElementById(columnId);
            const item = document.createElement("div");
            item.className = "item";
            item.draggable = true;
            item.innerHTML = `${text} <button class='delete-btn' onclick='deleteItem(this)'>X</button>`;

            item.addEventListener("dragstart", dragStart);
            item.addEventListener("dragend", dragEnd);

            column.appendChild(item);
            saveBoard();
        }

        function deleteItem(btn) {
            btn.parentElement.remove();
            saveBoard();
        }

        function drop(event, columnId) {
            event.preventDefault();
            if (draggedItem) {
                document.getElementById(columnId).appendChild(draggedItem);
                saveBoard();
            }
        }
    </script>
</body>
</html>
